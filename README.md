# ðŸš€ xiaozhi-esp32-server-golang

> **Xiaozhi AI Backend for ESP32 Devices**

---

## é¡¹ç›®ç®€ä»‹ | Project Overview

xiaozhi-esp32-server-golang æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€å…¨æµå¼çš„ AI åŽç«¯æœåŠ¡ï¼Œä¸“ä¸ºç‰©è”ç½‘ä¸Žæ™ºèƒ½è¯­éŸ³åœºæ™¯è®¾è®¡ã€‚é¡¹ç›®åŸºäºŽ Go è¯­è¨€å¼€å‘ï¼Œé›†æˆäº† ASRï¼ˆè‡ªåŠ¨è¯­éŸ³è¯†åˆ«ï¼‰ã€LLMï¼ˆå¤§è¯­è¨€æ¨¡åž‹ï¼‰ã€TTSï¼ˆè¯­éŸ³åˆæˆï¼‰ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼Œæ”¯æŒå¤§è§„æ¨¡å¹¶å‘ä¸Žå¤šåè®®æŽ¥å…¥ï¼ŒåŠ©åŠ›æ™ºèƒ½ç»ˆç«¯ä¸Žè¾¹ç¼˜è®¾å¤‡çš„ AI è¯­éŸ³äº¤äº’ã€‚

---

## âœ¨ ä¸»è¦ç‰¹æ€§ | Key Features

- ðŸš€ **ç«¯åˆ°ç«¯å…¨æµå¼ AI è¯­éŸ³é“¾è·¯**ï¼šASRï¼ˆè‡ªåŠ¨è¯­éŸ³è¯†åˆ«ï¼‰ã€LLMï¼ˆå¤§è¯­è¨€æ¨¡åž‹ï¼‰ã€TTSï¼ˆè¯­éŸ³åˆæˆï¼‰å…¨æµç¨‹æµå¼å¤„ç†ï¼Œæžè‡´ä½Žå»¶è¿Ÿï¼Œé€‚é…å®žæ—¶è¯­éŸ³äº¤äº’åœºæ™¯ã€‚
- ðŸ§© **ä¸»é€»è¾‘ä»£ç æ¢³ç†ä¸Žä¼˜åŒ–**ï¼šå¯¹ä¸»æµç¨‹ä»£ç ç»“æž„è¿›è¡Œç³»ç»Ÿæ€§æ¢³ç†ä¸Žé‡æž„ï¼Œæå‡å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ä¸Žæ‰©å±•æ€§ã€‚
- ðŸ› ï¸ **Transport æŽ¥å£å±‚æŠ½è±¡**ï¼šå°† WebSocketã€MQTTã€UDP ç­‰åè®®ç»Ÿä¸€æŠ½è±¡ä¸º Transport æŽ¥å£å±‚ï¼Œçµæ´»æ³¨å…¥ä¸»é€»è¾‘ï¼Œä¾¿äºŽåè®®æ‰©å±•ä¸Žåˆ‡æ¢ã€‚
- ðŸ“¬ **LLM/TTS æ¶ˆæ¯é˜Ÿåˆ—åŒ–å¤„ç†**ï¼šLLM ä¸Ž TTS å¤„ç†æµç¨‹é‡‡ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ–¹å¼ï¼Œæ”¯æŒå¼‚æ­¥å¤„ç†ä¸Žæ–°ä¸šåŠ¡é€»è¾‘çš„çµæ´»æ³¨å…¥ã€‚
- ðŸ”— **å¤šåè®®é«˜å¹¶å‘æŽ¥å…¥**ï¼šå†…ç½® WebSocketã€MQTTã€UDP ç­‰å¤šç§åè®®æœåŠ¡å™¨ï¼Œæ”¯æŒå¤§è§„æ¨¡è®¾å¤‡å¹¶å‘æŽ¥å…¥ä¸Žæ¶ˆæ¯æŽ¨é€ã€‚
- â™»ï¸ **é«˜æ•ˆèµ„æºæ± ä¸Žè¿žæŽ¥å¤ç”¨**ï¼šå¤–éƒ¨èµ„æºè¿žæŽ¥æ± æœºåˆ¶ï¼Œæ˜¾è‘—é™ä½Žå“åº”è€—æ—¶ï¼Œæå‡ç³»ç»Ÿåžåèƒ½åŠ›ã€‚
- ðŸ§  **å¤šå¼•æ“Ž AI èƒ½åŠ›é›†æˆï¼ŒåŸºäºŽ Eino æ¡†æž¶**ï¼šé¡¹ç›®åŸºäºŽ Eino æ¡†æž¶å¼€å‘ï¼Œæ”¯æŒ FunASRã€Eino LLMã€OpenAIã€Ollamaã€Doubaoã€EdgeTTSã€CosyVoice ç­‰å¤šç§ä¸»æµ AI å¼•æ“Žï¼Œçµæ´»åˆ‡æ¢ä¸Žæ‰©å±•ã€‚
- ðŸ›¡ï¸ **æ¨¡å—åŒ–ä¸Žå¯æ‰©å±•æž¶æž„**ï¼šå„æ ¸å¿ƒèƒ½åŠ›ï¼ˆVAD/ASR/LLM/TTS/MCP/è§†è§‰ï¼‰å‡ä¸ºç‹¬ç«‹æ¨¡å—ï¼Œä¾¿äºŽå®šåˆ¶ã€æ‰©å±•å’Œé›†æˆæ›´å¤š AI æœåŠ¡ã€‚
- ðŸ“¦ **ä¸€é”® Docker éƒ¨ç½² & è·¨å¹³å°æ”¯æŒ**ï¼šå®˜æ–¹ Dockerfileï¼Œæ”¯æŒä¸»æµ Linux å‘è¡Œç‰ˆä¸Žæœ¬åœ°ç¼–è¯‘ï¼Œå¿«é€Ÿè½åœ°éƒ¨ç½²ã€‚
- ðŸ“Š **é«˜æ€§èƒ½ä¸Žä½Žèµ„æºå ç”¨**ï¼šGolang åŽŸç”Ÿé«˜å¹¶å‘æž¶æž„ï¼ŒåŸºäºŽ Eino æ¡†æž¶ä¼˜åŒ–ï¼Œé€‚é…è¾¹ç¼˜è®¾å¤‡ä¸Žäº‘ç«¯ï¼Œèµ„æºå ç”¨ä½Žï¼Œç¨³å®šæ€§å¼ºã€‚
- ðŸ”’ **å®‰å…¨ä¸Žæƒé™ä½“ç³»ï¼ˆè§„åˆ’ä¸­ï¼‰**ï¼šé¢„ç•™ç”¨æˆ·è®¤è¯ã€æƒé™ç®¡ç†æŽ¥å£ï¼Œä¾¿äºŽåŽç»­é›†æˆä¼ä¸šçº§å®‰å…¨ä½“ç³»ã€‚
- ðŸ‘€ **è§†è§‰ä¸Žå¤šæ¨¡æ€èƒ½åŠ›æ‹“å±•**ï¼šæ”¯æŒè§†è§‰æ¨¡åž‹æŽ¥å…¥ï¼Œæ»¡è¶³å¤šæ¨¡æ€æ™ºèƒ½ç»ˆç«¯éœ€æ±‚ã€‚

---

## ðŸš€ å¿«é€Ÿå¼€å§‹ | Quick Start

1. **Docker ä¸€é”®éƒ¨ç½²**  
   [æŸ¥çœ‹ Docker å¿«é€Ÿå¼€å§‹æ–‡æ¡£ Â»](doc/docker.md)
2. **æœ¬åœ°ç¼–è¯‘ä¸Žè¿è¡Œï¼ˆä¼˜åŒ–ç‰ˆï¼‰**

   1. **å®‰è£…ä¾èµ–**
      - å®‰è£… Go 1.20+ï¼ˆå»ºè®®ä¸Ž Dockerfile ä¸­ä¸€è‡´çš„ç‰ˆæœ¬ï¼‰
      - å®‰è£… Opus ç›¸å…³ä¾èµ–ï¼š
        ```bash
        sudo apt-get update
        sudo apt-get install -y libopus0 libopusfile-dev
        ```
      - å®‰è£… ONNX Runtimeï¼š
        ```bash
        wget https://github.com/microsoft/onnxruntime/releases/download/v1.21.0/onnxruntime-linux-x64-1.21.0.tgz
        tar -xzf onnxruntime-linux-x64-1.21.0.tgz
        sudo mkdir -p /usr/local/include/onnxruntime
        sudo cp -r onnxruntime-linux-x64-1.21.0/include/* /usr/local/include/onnxruntime/
        sudo cp -r onnxruntime-linux-x64-1.21.0/lib/* /usr/local/lib/
        sudo ldconfig
        ```
      - è®¾ç½®çŽ¯å¢ƒå˜é‡ï¼ˆå¯å†™å…¥ `~/.bashrc` æˆ– `~/.zshrc`ï¼‰ï¼š
        ```bash
        export ONNXRUNTIME_DIR=/usr/local
        export CGO_CFLAGS="-I${ONNXRUNTIME_DIR}/include/onnxruntime"
        export CGO_LDFLAGS="-L${ONNXRUNTIME_DIR}/lib -lonnxruntime"
        ```

   2. **éƒ¨ç½² FunASR æœåŠ¡**
      - å‚è€ƒ [FunASR å®˜æ–¹æ–‡æ¡£](https://github.com/modelscope/FunASR/blob/main/runtime/docs/SDK_advanced_guide_online_zh.md) éƒ¨ç½²å¹¶å¯åŠ¨æœåŠ¡ã€‚

   3. **ç¼–è¯‘æœåŠ¡**

      - ç¼–è¯‘ï¼š
        ```bash
        go build -o xiaozhi_server ./cmd/server/
        ```

   4. **å‡†å¤‡é…ç½®æ–‡ä»¶**
      - å¤åˆ¶æˆ–ç¼–è¾‘ `config/config.json`ï¼Œæ ¹æ®å®žé™…çŽ¯å¢ƒè°ƒæ•´å‚æ•°ã€‚
      - è¯¦ç»†é…ç½®è¯´æ˜Žè¯·å‚è€ƒ [é…ç½®æ–‡æ¡£](doc/config.md)

   5. **å¯åŠ¨æœåŠ¡**
      ```bash
      ./xiaozhi_server -c config/config.json
      ```

   ### ðŸ“š ç›¸å…³æ–‡æ¡£ | Related Docs
   - [WebSocket æœåŠ¡å™¨ä¸Ž OTA é…ç½®è¯´æ˜Ž Â»](doc/websocket_server.md)
   - [MQTT+UDP æœåŠ¡å™¨é…ç½®æµç¨‹ Â»](doc/mqtt_udp.md)
   - [MQTT UDP åè®®ä¸Žæ•°æ®æµç¨‹ Â»](doc/mqtt_udp_protocol.md)
   - [Vision è§†è§‰è¯†åˆ« Â»](doc/vision.md)
   - [mcp æž¶æž„ Â»](doc/mcp.md)

   ---

   > âš ï¸ æŽ¨èåœ¨ Ubuntu 22.04 çŽ¯å¢ƒä¸‹æ“ä½œï¼Œç¡®ä¿ä¾èµ–ä¸€è‡´ã€‚
   > è‹¥é‡åˆ° ONNX Runtime ç›¸å…³çš„ CGO ç¼–è¯‘é—®é¢˜ï¼Œè¯·æ£€æŸ¥çŽ¯å¢ƒå˜é‡å’Œä¾èµ–è·¯å¾„ã€‚
   > æ—¥å¿—å’Œé…ç½®ç›®å½•å»ºè®®ä¸Ž Docker ä¿æŒä¸€è‡´ï¼ˆ`logs/`ã€`config/`ï¼‰ã€‚

---

## ðŸ§© æ¨¡å—æž¶æž„ | Module Overview

| æ¨¡å—      | åŠŸèƒ½ç®€ä»‹                       | æŠ€æœ¯æ ˆ/è¯´æ˜Ž                |
|-----------|-------------------------------|----------------------------|
| VAD       | å£°éŸ³æ´»åŠ¨æ£€æµ‹ï¼ˆSilero VADï¼‰    | Silero VAD, Webrtc vad                    |
| ASR       | è¯­éŸ³è¯†åˆ«ï¼ˆFunASRå¯¹æŽ¥ï¼‰        | FunASR          |
| LLM       | å¤§è¯­è¨€æ¨¡åž‹ï¼ˆOpenAIå…¼å®¹æŽ¥å£ï¼‰  | Einoæ¡†æž¶å…¼å®¹çš„ LLM, openai, ollama       |
| TTS       | è¯­éŸ³åˆæˆï¼ˆå¤šå¼•æ“Žæ”¯æŒï¼‰        | Doubao, EdgeTTS, CosyVoice |
| MCP       | å¤šåè®®æŽ¥å…¥ | æ”¯æŒå…¨å±€MCPã€MCPæŽ¥å…¥ç‚¹ã€ç«¯ä¾§MCP Serverï¼‰       |
| è§†è§‰      | è§†è§‰å¤„ç†ç›¸å…³èƒ½åŠ›                                    |  æ”¯æŒ doubao, aliyun è§†è§‰æ¨¡åž‹      |

---

## ðŸ“ˆ æ€§èƒ½ä¸Žæµ‹è¯• | Performance & Testing

- [å»¶è¿Ÿæµ‹è¯•æŠ¥å‘Š](doc/delay_test.md)
- é«˜å¹¶å‘åœºæ™¯ä¸‹ç¨³å®šè¿è¡Œï¼Œèµ„æºå ç”¨ä½Ž

---

## ðŸ› ï¸ TODO & è§„åˆ’
- [x] å®Œå–„ Docker åŒ–éƒ¨ç½²
- [ ] ç”¨æˆ·è®¤è¯ä¸Žæƒé™ä½“ç³»
- [ ] é›†æˆæ›´å¤šäº‘åŽ‚å•† ASR æœåŠ¡
- [ ] Web ç”¨æˆ·ç•Œé¢
- [ ] LLM è®°å¿†ä½“å¢žå¼º


---

## ðŸ¤ è´¡çŒ® | Contributing

æ¬¢è¿Žæäº¤ Issueã€PR æˆ–å»ºè®®ï¼å¦‚æœ‰åˆä½œæ„å‘è¯·è”ç³»ä½œè€…ã€‚

---

## ðŸ“„ License

æœ¬é¡¹ç›®éµå¾ª MIT Licenseã€‚

---

## ðŸ“¬ è”ç³»æ–¹å¼ | Contact
äº¤æµç¾¤äºŒç»´ç 

![å¾®ä¿¡å›¾ç‰‡_20250714093831(1)](https://github.com/user-attachments/assets/68364ce3-d507-4030-910e-fe1585fe5055)



ä¸ªäººå¾®ä¿¡ï¼šhackers365

![ä¸ªäººäºŒç»´ç _0618(1)](https://github.com/user-attachments/assets/6b8d3d11-7bf5-4fa4-a73e-5109019dab85)

---

> Â© 2024 xiaozhi-esp32-server-golang. All rights reserved.


